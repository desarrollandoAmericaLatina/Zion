{% extends "base.html" %}
{% block title %}Roba.me | Delitos en un solo clic{% endblock %}
{% block script %}
		<script type="text/javascript" src="/static/js/custom.js"></script>
		<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true&language=es" ></script>
		<script type="text/javascript">
			function getGeolocation() {
				if (navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(showPosition);
				} 
			}
			function showPosition(position) {
				var lat = position.coords.latitude;
				var lng = position.coords.longitude;
				var options = { zoom: 13, center: new google.maps.LatLng(lat, lng), mapTypeId: google.maps.MapTypeId.ROADMAP }
				var map = new google.maps.Map($("#canvas").get(0), options);
				google.maps.event.addListener(map, 'click', function(event) {
				var clickedLocation = new google.maps.LatLng(event.latLng);
					var marker = new google.maps.Marker({
						position: event.latLng, 
						map: map,
						icon: "/static/image/smiley.png"
					});
					document.getElementById("comentarioForm").style.display='block';
					document.getElementById("id_latitud").value=event.latLng.lat();
					document.getElementById("id_longitud").value=event.latLng.lng();
					map.addOverlay(marker);
				});
			}
			function cancelarSaveData(){
				document.getElementById("id_descripcion").value='';
				document.getElementById("id_latitud").value='0';
				document.getElementById("id_longitud").value='0';
				document.getElementById("comentarioForm").style.display='none';
				marker.setVisible(true);
			}
			function imposeMaxLength(Object, MaxLen) {
				return (Object.value.length <= MaxLen);
			}
		</script>
{% endblock %}
{% block body %}
	<body onload="getGeolocation()" onunload="GUnload()">
{% endblock %}	
{% block info_usuario %}
	{% if userTrue %}
		<div id="info-user">
			<div id="user-name">Linus Torvals
				<a href="#">Cerrar Sesión</a>
			</div>
		</div>
	{% else %}
		<div id="pre-sesion">
			¿Tienes Cuenta?
			<a href="#">Iniciar Sesión</a>
		</div>
		<form>
			<label>Usuario</label>
			<input class="textbox" type="text">
			<label>Password</label>
			<input class="textbox" type="password">
			<input id="btn-sesion" class="btn-session" type="button" value="Iniciar Sesión">
		</form>			
	{% endif %}
{% endblock %}
{% block content-left %}
	<ul id="ultimos-robos">
<a href="javascript:obtener_localizacion();">Mostrar coordenadas</a>
		<li class="robo first">
			<span class="head-robo"><span class="fecha-robo">28 de Marzo 2011</span> a las 20:05 en <a class="lugar" href="#">Huancayo</a></span>
			<p class="denuncia"><a href="#">#acuchillamiento</a>en el Jr. Azangaro tengan cuidado esta peligrosa la zona</p>
		</li>
		<li class="robo">
			<span class="head-robo"><span class="fecha-robo">28 de Marzo 2011</span> a las 20:10 en <a class="lugar" href="#">Lima</a></span>
			<p class="denuncia"><a href="#">#roboalpaso</a>en la av. Salaverry no vaya por ahy.</p>
		</li>
		<li class="robo last">
			<span class="head-robo"><span class="fecha-robo">29 de Marzo 2011</span> a las 10:40 en <a class="lugar" href="#">Lima</a></span>
			<p class="denuncia"><a href="#">#locosuelto</a>psj. Moscú. Loco tirando piedra.</p>
		</li>
	</ul>
	<div id="mas"><span><a href="/mas/"><div id="icon-mas">más</div></a></span></div>
{% endblock %}
{% block content-right %}
<div id="canvas" style="width: 100%; height: 400px;"></div>
<div id="comment">
	<form action="/" method="post" id="comentarioForm" name="comentarioForm">
		<textarea id="id_descripcion" name="descripcion" placeholder="¿Qué ocurrió?" onkeypress="return imposeMaxLength(this, 160);" /></textarea><br/>
		{{asaltoForm.descripcion.errors}}
		<input type='hidden' id='id_latitud' name='latitud' value='0' />
		<input type='hidden' id='id_longitud' name='longitud' value='0' />
		<input type="submit" value="Informar"/>
		<input type="button" value="Cancelar" onclick="cancelarSaveData()"/>
	</form>
</div>
<div id="how-map">
{% if envioValido %}
Para denunciar ubica el lugar en el mapa.
{% else %}
Hubo errores guardando, vuelvelo a intentarlo.
{% endif %}
</div>
{% endblock %}
